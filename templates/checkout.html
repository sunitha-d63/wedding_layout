{% extends "layout/base.html" %} {% block styles %}
 <link rel="stylesheet" href="{{ url_for('static', filename='css/checkout.css') }}">
{% endblock %} {% block content %}
<div class="container py-5 fs-5">
  <div class="row gx-4 gy-5">
    <div class="col-md-7">
      <div class="card shadow-sm p-4">
        <img src="{{ url_for('static', filename='images/allcards.png') }}" alt="UPI"/>
        <h4 class="mb-4">Shipping & Payment</h4>
        <form method="post" action="#">
          <div class="row g-3 mb-4">
            <div class="col-md-6">
              <input
                type="text"
                name="name"
                class="form-control"
                placeholder="Full Name"
                required
              />
            </div>
            <div class="col-md-6">
              <input
                type="email"
                name="email"
                class="form-control"
                placeholder="Email"
                required
              />
            </div>
            <div class="col-md-6">
              <input
                type="tel"
                name="phone"
                class="form-control"
                placeholder="Phone"
                required
              />
            </div>
            <div class="col-md-12">
              <textarea
                name="address"
                rows="2"
                class="form-control"
                placeholder="Shipping Address"
                required
              ></textarea>
            </div>
          </div>

          <h5 class="mb-3">Payment Method</h5>
          {% for m in methods %}
          <div
            class="form-check payment-option mb-2 d-flex justify-content-between align-items-center"
          >
            <div class="d-flex align-items-center">
              <input id="pm{{ loop.index }}" class="form-check-input me-2"
              type="radio" name="payment_method" value="{{ m.name }}" {% if
              request.form.payment_method == m.name %}checked{% endif %}>
              <label class="form-check-label mb-0" for="pm{{ loop.index }}">
                {{ m.name }}
              </label>
            </div>
            <img
              src="{{ url_for('static', filename=m.image) }}"
              alt="{{ m.name }}"
              class="img-fluid"
              style="height: 24px"
            />
          </div>
          {% endfor %} {% if error %}
          <div class="alert alert-danger mt-3">{{ error }}</div>
          {% endif %}

          <button
            type="submit"
            name="action"
            value="pay"
            class="btn btn-warning w-100 mt-4"
          >
            Pay Rs{{ "%.2f"|format(total) }}
          </button>
        </form>
         <div class="small text-muted mt-3 mb-4">
              * Credit card payments may take up to 24 hours to be processed!<br>
              <input type="checkbox" id="saveInfo"><label for="saveInfo">
                Save my payment details for future purchase</label>
            </div>
      </div>
    </div>
    <div class="col-md-5">
      <div class="card shadow-sm p-4">
        <h5 class="mb-4 text-center">Order Summary</h5>
        <div class="mb-3">
          <div class="d-flex justify-content-between">
            <span>Date:</span><span>{{ date }}</span>
          </div>
          <div class="d-flex justify-content-between">
            <span>Time:</span><span>{{ time }}</span>
          </div>
        </div>
        <hr />
        <div>
          {% for item in checkout_items %}
          <div class="d-flex align-items-center mb-3 checkout-item">
            <img
              src="{{ item.image_url or item.src }}"
              alt="{{ item.title }}"
              class="rounded me-3"
            />
            <div class="flex-grow-1">
              <h6 class="mb-1">{{ item.title }}</h6>
              <small class="text-muted"
                >Qty: {{ item.quantity or item.qty }}</small
              ><br />
              <span
                >Rs{{ "%.2f"|format((item.quantity or item.qty) * item.price)
                }}</span
              >
            </div>
          </div>
          {% endfor %}
        </div>
        <hr />
        <table class="table">
          <tr>
            <td>Subtotal</td>
            <td class="text-end">Rs{{ "%.2f"|format(subtotal) }}</td>
          </tr>
          <tr>
            <td>Shipping</td>
            <td class="text-end">
              Rs0.00 <small class="badge bg-secondary">Free</small>
            </td>
          </tr>
          {% if coupon_applied %}
          <tr>
            <td>Coupon (<em>{{ coupon_code }}</em>)</td>
            <td class="text-end text-success">
              âˆ’Rs{{ "%.2f"|format(coupon_discount) }}
            </td>
          </tr>
          {% endif %}
          <tr class="fw-bold">
            <td>Total</td>
            <td class="text-end">Rs{{ "%.2f"|format(total) }}</td>
          </tr>
        </table>
        <a
          href="{{ url_for('home') }}"
          class="btn btn-outline-primary w-100 mt-2"
        >
          <i class="bi bi-arrow-left me-1"></i> Continue Shopping
        </a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
